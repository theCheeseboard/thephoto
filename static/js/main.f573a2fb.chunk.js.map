{"version":3,"sources":["screens/CameraHud.module.css","screens/TransferItem.module.css","screens/TransfersScreen.module.css","TransferController.js","assets/camera-unavailable.svg","WsController.js","welcome.jsx","screens/Header.jsx","screens/CameraHud.jsx","screens/CameraScreen.jsx","screens/TransferItem.jsx","screens/TransfersScreen.jsx","screens/UploadScreen.jsx","screens/MainScreen.jsx","App.jsx","reportWebVitals.js","index.js","screens/CameraScreen.module.css","screens/UploadScreen.module.css"],"names":["module","exports","controller","_defs","TransferJob","this","value","emit","TransferController","job","push","EventEmitter","WsController","handler","room","username","Promise","res","rej","wsUrl","process","WebSocket","onopen","event","sendMessage","type","msg","user","onerror","onclose","onmessage","wsMessage","bind","a","data","arrayBuffer","Response","decoder","TextDecoder","JSON","parse","decode","replyTo","message","replyHandler","seq","userId","payload","TextEncoder","encode","stringify","send","isConnected","close","picture","makeTransferJob","setImageData","mimeType","substring","indexOf","substr","setTotal","length","sendChunk","replySeq","pictureData","progress","total","continue","addProgress","Welcome","props","state","error","connect","catch","setState","className","onChange","e","target","renderError","onClick","React","Component","Header","changePage","onExit","page","onChangePage","button","classes","join","CameraHud","Styles","CaptureButton","onCapture","width","height","fill","stroke","cx","cy","r","strokeWidth","CaptureButtonInnerCircle","_excluded","_extends","Object","assign","i","arguments","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","SvgCameraUnavailable","_ref","svgRef","title","titleId","viewBox","id","ref","transform","style","fillOpacity","color","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","fontVariantLigatures","fontVariantPosition","fontVariantCaps","fontVariantNumeric","fontVariantAlternates","fontFeatureSettings","textIndent","textAlign","textDecoration","textDecorationLine","textDecorationStyle","textDecorationColor","letterSpacing","wordSpacing","textTransform","writingMode","direction","textOrientation","dominantBaseline","baselineShift","textAnchor","whiteSpace","shapePadding","clipRule","display","overflow","visibility","opacity","isolation","mixBlendMode","colorInterpolation","colorInterpolationFilters","solidColor","solidOpacity","vectorEffect","fillRule","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeDasharray","strokeDashoffset","strokeOpacity","colorRendering","imageRendering","shapeRendering","textRendering","enableBackground","d","fontVariantEastAsian","fontVariationSettings","shapeMargin","inlineSize","stopColor","stopOpacity","ForwardRef","CameraScreen","webcam","createRef","errorState","videoConstraints","facingMode","frameRate","audio","onUserMedia","mediaStream","onUserMediaError","mediaError","screenshotFormat","CameraWebcam","capture","CameraError","CameraErrorContainer","CameraErrorGlyph","CameraPage","renderPage","console","log","name","current","getScreenshot","sendBase64Picture","TransferItem","percent","setInterval","centerX","centerY","radius","angleInDegrees","angleInRadians","Math","PI","x","cos","y","sin","startAngle","endAngle","start","polarToCartesian","end","arcSweep","percentComplete","describeArc","backgroundImage","imageData","Spinner","renderProgressPath","TransfersScreen","jobs","on","progressUpdated","removeListener","reverse","TransferGrid","map","UploadScreen","isDropping","filePicker","dataTransfer","types","includes","preventDefault","stopPropagation","files","items","Array","from","filter","item","kind","getAsFile","uploadFiles","click","file","Error","reader","FileReader","readAsDataURL","onloadend","result","onUploadSelected","err","Dropping","cls","onDragEnter","dragEnter","onDragLeave","dragLeave","onDragOver","dragOver","onDrop","drop","UploadContainer","UploadButton","pickFileClicked","multiple","pickFile","FilePicker","MainScreen","disconnect","exit","App","setWsStateChangeHandler","renderMainPage","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f573a2fb.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"CameraHud\":\"CameraHud_CameraHud__NBjqx\",\"CaptureButton\":\"CameraHud_CaptureButton__1t8n5\",\"CaptureButtonInnerCircle\":\"CameraHud_CaptureButtonInnerCircle__6jy9s\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"TransferItem\":\"TransferItem_TransferItem__3io49\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"TransferGrid\":\"TransfersScreen_TransferGrid__Jhz2X\"};","import EventEmitter from \"eventemitter3\";\n\nlet controller;\n\nclass TransferJob {\n    #progress;\n    #total;\n    #imageData;\n    \n    constructor() {\n        this.#progress = 0;\n        this.#total = 0;\n    }\n    \n    setProgress(value) {\n        this.#progress = value;\n        controller.emit(\"progressUpdated\");\n    }\n    \n    addProgress(value) {\n        this.#progress += value;\n        controller.emit(\"progressUpdated\");\n    }\n    \n    setTotal(value) {\n        this.#total = value;\n        controller.emit(\"progressUpdated\");\n    }\n    \n    setImageData(value) {\n        this.#imageData = value;\n    }\n\n    imageData() {\n        return this.#imageData;\n    }\n    \n    progress() {\n        return this.#progress;\n    }\n    \n    total() {\n        return this.#total;\n    }\n\n    percentComplete() {\n        return this.#progress / this.#total;\n    }\n}\n\nclass TransferController extends EventEmitter {\n    #jobs;\n\n    constructor() {\n        super();\n        this.#jobs = [];\n    }\n\n    makeTransferJob() {\n        let job = new TransferJob();\n        this.#jobs.push(job);\n        return job;\n    }\n\n    jobs() {\n        // return [...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs, ...this.#jobs];\n        return this.#jobs;\n    }\n}\n\ncontroller = new TransferController();\nexport default controller;","var _defs;\n\nvar _excluded = [\"title\", \"titleId\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgCameraUnavailable(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 128,\n    height: 128,\n    viewBox: \"0 0 33.866666 33.866668\",\n    id: \"svg8\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _defs || (_defs = /*#__PURE__*/React.createElement(\"defs\", {\n    id: \"defs2\"\n  })), /*#__PURE__*/React.createElement(\"g\", {\n    id: \"layer1\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"g855\",\n    transform: \"matrix(6.8558595,0,0,6.8547919,-93.717829,-100.95504)\",\n    style: {\n      strokeWidth: 0.145872,\n      fill: \"#000000\",\n      fillOpacity: 0.5\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"rect841-6\",\n    style: {\n      color: \"#000000\",\n      fontStyle: \"normal\",\n      fontVariant: \"normal\",\n      fontWeight: \"normal\",\n      fontStretch: \"normal\",\n      fontSize: \"medium\",\n      lineHeight: \"normal\",\n      fontFamily: \"sans-serif\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontFeatureSettings: \"normal\",\n      textIndent: 0,\n      textAlign: \"start\",\n      textDecoration: \"none\",\n      textDecorationLine: \"none\",\n      textDecorationStyle: \"solid\",\n      textDecorationColor: \"#000000\",\n      letterSpacing: \"normal\",\n      wordSpacing: \"normal\",\n      textTransform: \"none\",\n      writingMode: \"lr-tb\",\n      direction: \"ltr\",\n      textOrientation: \"mixed\",\n      dominantBaseline: \"auto\",\n      baselineShift: \"baseline\",\n      textAnchor: \"start\",\n      whiteSpace: \"normal\",\n      shapePadding: 0,\n      clipRule: \"nonzero\",\n      display: \"inline\",\n      overflow: \"visible\",\n      visibility: \"visible\",\n      opacity: 1,\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      colorInterpolation: \"sRGB\",\n      colorInterpolationFilters: \"linearRGB\",\n      solidColor: \"#000000\",\n      solidOpacity: 1,\n      vectorEffect: \"none\",\n      fill: \"#000000\",\n      fillOpacity: 0.5,\n      fillRule: \"nonzero\",\n      stroke: \"none\",\n      strokeWidth: 0.0385953,\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 4,\n      strokeDasharray: \"none\",\n      strokeDashoffset: 0,\n      strokeOpacity: 1,\n      colorRendering: \"auto\",\n      imageRendering: \"auto\",\n      shapeRendering: \"auto\",\n      textRendering: \"auto\",\n      enableBackground: \"accumulate\"\n    },\n    d: \"m 15.610417,16.139584 c -0.265508,0 -0.505815,0.102097 -0.691948,0.264583 H 14.419792 A 0.1323049,0.1323049 0 0 0 14.2875,16.536459 v 1.322916 a 0.1323049,0.1323049 0 0 0 0.132292,0.132292 h 0.364835 l 0.249597,-0.249597 c -0.134065,-0.141993 -0.217557,-0.332417 -0.217557,-0.544153 0,-0.439943 0.353807,-0.79375 0.79375,-0.79375 0.211735,0 0.40216,0.08349 0.544152,0.217558 l 0.217558,-0.217558 h -0.06976 c -0.186133,-0.162486 -0.42644,-0.264583 -0.691947,-0.264583 z m 2.092378,0.05633 -0.472839,0.472839 h 0.364836 a 0.1323049,0.1323049 0 0 1 0.132291,0.132292 v 0.264583 a 0.1323049,0.1323049 0 0 1 -0.132291,0.132292 h -0.529167 a 0.1323049,0.1323049 0 0 1 -0.132292,-0.132292 v -0.100252 l -0.649572,0.649573 c -0.06458,0.104391 -0.151924,0.191739 -0.256316,0.256315 l -0.381372,0.381372 c 0.251017,-0.0089 0.478725,-0.105959 0.656291,-0.260966 h 1.557011 a 0.1323049,0.1323049 0 0 0 0.132292,-0.132292 V 16.536462 A 0.1323049,0.1323049 0 0 0 17.859375,16.40417 h -0.132292 v -0.132292 a 0.1323049,0.1323049 0 0 0 -0.02429,-0.07596 z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      color: \"#000000\",\n      fontStyle: \"normal\",\n      fontVariant: \"normal\",\n      fontWeight: \"normal\",\n      fontStretch: \"normal\",\n      fontSize: \"medium\",\n      lineHeight: \"normal\",\n      fontFamily: \"sans-serif\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      textIndent: 0,\n      textAlign: \"start\",\n      textDecoration: \"none\",\n      textDecorationLine: \"none\",\n      textDecorationStyle: \"solid\",\n      textDecorationColor: \"#000000\",\n      letterSpacing: \"normal\",\n      wordSpacing: \"normal\",\n      textTransform: \"none\",\n      writingMode: \"lr-tb\",\n      direction: \"ltr\",\n      textOrientation: \"mixed\",\n      dominantBaseline: \"auto\",\n      baselineShift: \"baseline\",\n      textAnchor: \"start\",\n      whiteSpace: \"normal\",\n      shapePadding: 0,\n      shapeMargin: 0,\n      inlineSize: 0,\n      clipRule: \"nonzero\",\n      display: \"inline\",\n      overflow: \"visible\",\n      visibility: \"visible\",\n      opacity: 1,\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      colorInterpolation: \"sRGB\",\n      colorInterpolationFilters: \"linearRGB\",\n      solidColor: \"#000000\",\n      solidOpacity: 1,\n      vectorEffect: \"none\",\n      fill: \"#000000\",\n      fillOpacity: 0.5,\n      fillRule: \"nonzero\",\n      stroke: \"none\",\n      strokeWidth: \"0.0385953px\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 4,\n      strokeDasharray: \"none\",\n      strokeDashoffset: 0,\n      strokeOpacity: 1,\n      colorRendering: \"auto\",\n      imageRendering: \"auto\",\n      shapeRendering: \"auto\",\n      textRendering: \"auto\",\n      enableBackground: \"accumulate\",\n      stopColor: \"#000000\",\n      stopOpacity: 1\n    },\n    d: \"m 17.871094,15.345703 a 0.1322915,0.1322915 0 0 0 -0.105469,0.03906 l -3.439453,3.439453 a 0.1322915,0.1322915 0 0 0 0,0.1875 0.1322915,0.1322915 0 0 0 0.1875,0 l 3.439453,-3.439453 a 0.1322915,0.1322915 0 0 0 0,-0.1875 0.1322915,0.1322915 0 0 0 -0.08203,-0.03906 z\",\n    id: \"path859\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCameraUnavailable);\nexport default __webpack_public_path__ + \"static/media/camera-unavailable.4ef8fb1c.svg\";\nexport { ForwardRef as ReactComponent };","import TransferController from './TransferController';\n\nclass WsController {\n    #ws;\n    #username;\n    #wsStateChangeHandler;\n    #connected;\n    #userId;\n    \n    #seq;\n    #replies;\n    \n    constructor() {\n        this.#ws = null;\n        this.#seq = 0;\n        this.#replies = {};\n    }\n    \n    setWsStateChangeHandler(handler) {\n        this.#wsStateChangeHandler = handler;\n    }\n    \n    connect(room, username) {\n        return new Promise((res, rej) => {\n            // let wsUrl = \"ws://\" + room + \":26158/\";\n            let wsUrl = `${process.env.REACT_APP_RENDEZVOUS_SERVER}/rendezvous/${room}`\n            this.#ws = new WebSocket(wsUrl);\n            this.#ws.onopen = (event) => {\n                this.sendMessage({\n                    type: \"connect\",\n                    username: username\n                }, (msg) => {\n                    this.#connected = true;\n                    this.#userId = msg.user;\n                    this.#wsStateChangeHandler();\n                    res();\n                });\n            };\n            this.#ws.onerror = (event) => {\n                this.#ws = null;\n                this.#connected = false;\n                \n                this.#wsStateChangeHandler();\n                rej();\n            }\n            this.#ws.onclose = (event) => {\n                this.#ws = null;\n                this.#connected = false;\n                this.#userId = null;\n                this.#wsStateChangeHandler();\n            }\n            this.#ws.onmessage = this.wsMessage.bind(this);\n        });\n    }\n    \n    async wsMessage(event) {\n        let data;\n        if (event.data.arrayBuffer) {\n            data = await event.data.arrayBuffer();\n        } else {\n            data = await new Response(event.data).arrayBuffer();\n        }\n        \n        //TODO: decrypt data\n        \n        let decoder = new TextDecoder(\"utf-8\");\n        let msg = JSON.parse(decoder.decode(data));\n\n        if (msg.type === \"serverKeepalive\") return; //Keepalive message\n        \n        if (msg.replyTo !== null) {\n            this.#replies[msg.replyTo](msg);\n        }\n    }\n    \n    isConnected() {\n        return this.#connected;\n    }\n    \n    sendMessage(message, replyHandler) {\n        message.seq = this.#seq++;\n        \n        if (this.#userId !== null) {\n            message.userId = this.#userId;\n        }\n        \n        let textEncoder = new TextEncoder();\n        let payload = textEncoder.encode(JSON.stringify(message));\n        \n        //TODO: encrypt payload\n        \n        this.#ws.send(payload);\n        \n        if (replyHandler !== null) {\n            this.#replies[message.seq] = replyHandler;\n        }\n        \n        return message.seq;\n    }\n    \n    disconnect() {\n        if (this.isConnected()) {\n            this.sendMessage({\n                type: \"disconnect\",\n                userId: this.#userId\n            }, () => this.#ws.close.bind(this));\n        }\n        this.#ws.close();\n    }\n    \n    sendBase64Picture(picture) {\n        let job = TransferController.makeTransferJob();\n        job.setImageData(picture);\n        \n        let mimeType = picture.substring(5, picture.indexOf(\";\"));\n        \n        picture = picture.substr(picture.indexOf(\"base64,\") + 7);\n        job.setTotal(picture.length);\n        \n        //Send the picture a few chunks at a time\n        let sendChunk = (replySeq) => {\n            let pictureData = picture.substr(job.progress(), 131072);\n            let message = {\n                type: \"picture\",\n                length: picture.length,\n                mimeType: mimeType,\n                data: pictureData\n            };\n            \n            if (replySeq !== null) {\n                message.replyTo = replySeq;\n            }\n            \n            this.sendMessage(message, (data) => {\n                if (job.progress() >= job.total()) {\n                    //We're done here\n                    //TODO: change the state of the transfer\n                } else {\n                    if (data.continue) sendChunk(data.replyTo);\n                }\n            });\n            job.addProgress(pictureData.length);\n        };\n        \n        sendChunk();\n    }\n}\n\nlet controller = new WsController();\n\nexport default controller;","import React from 'react';\n\nimport WsController from './WsController'\n\nclass Welcome extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            room: \"\",\n            username: \"\",\n            error: \"\"\n        }\n    }\n    \n    connect() {\n        if (this.state.username === \"\") {\n            this.setState({\n                error: \"Enter a username\"\n            });\n            return;\n        }\n        \n        WsController.connect(this.state.room, this.state.username).catch((error) => {\n            this.setState({\n                error: \"Check the room code and try again\"\n            });\n            return;\n        });\n    }\n    \n    renderError() {\n        if (this.state.error === \"\") return null;\n        return <span className=\"error\">{this.state.error}</span>\n    }\n    \n    render() {\n        return <div className=\"welcomeWrapper\">\n            <div className=\"welcomeContainer\">\n                <h1>Welcome to thePhoto</h1>\n                <p>For the best experience, grab the app:</p>\n                <hr />\n                <h2>Connect</h2>\n                <p>You can also connect using your web browser.</p>\n                \n                <div className=\"welcomeForm\">\n                    <span>Room</span>\n                    <input type=\"text\" value={this.state.room} onChange={(e => this.setState({room: e.target.value}))}/>\n                    \n                    <span>Username</span>\n                    <input type=\"text\" value={this.state.username} onChange={(e => this.setState({username: e.target.value}))}/>\n                    \n                    {this.renderError()}\n                    <button onClick={this.connect.bind(this)}>Connect</button>\n                </div>\n            </div>\n        </div>\n    }\n}\n\nexport default Welcome;","import React from 'react';\n\nclass Header extends React.Component {\n    render() {\n        return <div className=\"header\">\n            <div className=\"systemButton menu\" />\n            <div className={this.className(\"camera\")} onClick={() => this.changePage(\"camera\")}>Camera</div>\n            <div className={this.className(\"transfers\")} onClick={() => this.changePage(\"transfers\")}>Transfers</div>\n            <div className={this.className(\"upload\")} onClick={() => this.changePage(\"upload\")}>Upload</div>\n            <div className=\"spacer\" />\n            <div className=\"systemButton close\" onClick={this.props.onExit} />\n        </div>;\n    }\n    \n    changePage(page) {\n        this.props.onChangePage(page);\n    }\n    \n    className(button) {\n        let classes = [\"headerButton\", button];\n        if (this.props.page === button) classes.push(\"selected\");\n        return classes.join(\" \");\n    }\n}\n\nexport default Header;","import React from 'react';\n\nimport Styles from './CameraHud.module.css';\n\nclass CameraHud extends React.Component {\n    render() {\n        return <div className={Styles.CameraHud}>\n            <div className={Styles.CaptureButton} onClick={this.props.onCapture}>\n                <svg width={100} height={100}>\n                    <circle fill={\"#00000000\"} stroke={\"#ffffff\"} cx={50} cy={50} r={45} strokeWidth={5} />\n                    <circle className={Styles.CaptureButtonInnerCircle} />\n                </svg>\n            </div>\n        </div>\n    }\n}\n\nexport default CameraHud;","import React from 'react';\n\nimport CameraHud from './CameraHud';\nimport Webcam from \"react-webcam\";\nimport { ReactComponent as CameraUnavailable } from \"../assets/camera-unavailable.svg\";\n\nimport Styles from './CameraScreen.module.css';\n\nimport WsController from '../WsController'\n\nclass CameraScreen extends React.Component {\n    webcam;\n    \n    constructor(props) {\n        super(props);\n        \n        this.webcam = React.createRef();\n        \n        this.state = {\n            errorState: \"noError\",\n            videoConstraints: {\n                facingMode: \"environment\",\n                width: 4096,\n                height: 2160,\n                frameRate: 60\n            }\n        }\n    }\n    \n    renderPage() {\n        switch (this.state.errorState) {\n            case \"noError\":\n                return <>\n                    <Webcam\n                        audio={false}\n                        ref={this.webcam}\n                        onUserMedia={this.mediaStream.bind(this)}\n                        onUserMediaError={this.mediaError.bind(this)}\n                        videoConstraints={this.state.videoConstraints}\n                        screenshotFormat=\"image/png\"\n                        className={Styles.CameraWebcam} />\n                    <CameraHud\n                        onCapture={this.capture.bind(this)} />\n\n                </>\n            case \"noCamera\":\n                return <div className={Styles.CameraError}>\n                    <div className={Styles.CameraErrorContainer}>\n                        <CameraUnavailable className={Styles.CameraErrorGlyph} />\n                        <h1>There is no camera on this device.</h1>\n                    </div>\n                </div>\n            case \"noSupport\":\n                return <div className={Styles.CameraError}>\n                    <div className={Styles.CameraErrorContainer}>\n                        <CameraUnavailable className={Styles.CameraErrorGlyph} />\n                        <h1>This browser is unsupported</h1>\n                        <div>\n                            <p>Use a browser that can access the camera. Possible options are:</p>\n                            <ul>\n                                <li>Google Chrome</li>\n                                <li>Firefox</li>\n                                <li>Safari</li>\n                                <li>Microsoft Edge</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            case \"noPermission\":\n                return <div className={Styles.CameraError}>\n                    <div className={Styles.CameraErrorContainer}>\n                        <CameraUnavailable className={Styles.CameraErrorGlyph} />\n                        <h1>Can't access the camera</h1>\n                        <div>\n                            <p>Check the permissions for this page, and then reload the page to try again.</p>\n                        </div>\n                    </div>\n                </div>\n            case \"genericError\":\n            default:\n                return <div className={Styles.CameraError}>\n                    <div className={Styles.CameraErrorContainer}>\n                        <CameraUnavailable className={Styles.CameraErrorGlyph} />\n                        <h1>Can't access the camera</h1>\n                    </div>\n                </div>\n        }\n    }\n    \n    render() {\n        return <div className={Styles.CameraPage}>\n            {this.renderPage()}\n        </div>\n    }\n    \n    mediaStream(event) {\n        console.log(event);\n    }\n    \n    mediaError(error) {\n        console.log(error);\n        if (error.message === \"getUserMedia is not implemented in this browser\") {\n                this.setState({\n                    errorState: \"noSupport\"\n                });\n            return;\n        }\n        \n        switch (error.name) {\n            case \"NotFoundError\":\n                this.setState({\n                    errorState: \"noCamera\"\n                });\n                break;\n            case \"NotAllowedError\":\n                this.setState({\n                    errorState: \"noPermission\"\n                });\n                break;\n            default:\n                this.setState({\n                    errorState: \"genericError\"\n                });\n                break;\n        }\n    }\n    \n    capture() {\n        let picture = this.webcam.current.getScreenshot();\n        WsController.sendBase64Picture(picture);\n    }\n}\n\nexport default CameraScreen;","import React from \"react\";\n\nimport Styles from \"./TransferItem.module.css\";\n\nclass TransferItem extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            percent: 1\n        }\n    }\n\n    componentDidMount() {\n        setInterval(() => {\n            this.setState(state => ({\n                percent: state.percent > 1.5 ? 0 : state.percent + 0.01\n            }));\n        }, 10);\n    }\n\n    polarToCartesian(centerX, centerY, radius, angleInDegrees) {\n        let angleInRadians = (angleInDegrees-90) * Math.PI / 180.0;\n\n        return {\n            x: centerX + (radius * Math.cos(angleInRadians)),\n            y: centerY + (radius * Math.sin(angleInRadians))\n        };\n    }\n\n    describeArc(x, y, radius, startAngle, endAngle){\n        let start = this.polarToCartesian(x, y, radius, endAngle);\n        let end = this.polarToCartesian(x, y, radius, startAngle);\n\n        let arcSweep = endAngle - startAngle <= 180 ? \"0\" : \"1\";\n\n        let d = [\n            \"M\", start.x, start.y,\n            \"A\", radius, radius, 0, arcSweep, 0, end.x, end.y,\n            // \"L\", x,y,\n            // \"L\", start.x, start.y\n        ].join(\" \");\n\n        return d;\n    }\n\n    renderProgressPath() {\n        let percent = this.props.job.percentComplete();\n        if (percent >= 1) {\n            return <>\n                <circle id={\"circle\"} stroke={\"#ffffff\"} fill={\"#00000000\"} strokeWidth={10} cx={55} cy={55} r={50} />\n                <path id={\"check\"} stroke={\"#ffffff\"} fill={\"#00000000\"} strokeWidth={10} d=\"M 30 60 L 50 75 L 75 30\" />\n            </>\n        } else {\n            return <path id={\"arc\"} stroke={\"#ffffff\"} fill={\"#00000000\"} strokeWidth={10} d={this.describeArc(55, 55, 50, 0, percent * 360)} />\n        }\n    }\n\n    render() {\n        return <div className={Styles.TransferItem} style={{\n            backgroundImage: `linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ), url(\"${this.props.job.imageData()}\")`\n        }}>\n            <svg className={Styles.Spinner} width={110} height={110}>\n                {/*<circle cx={50} cy={50} r={50} />*/}\n                {this.renderProgressPath()}\n            </svg>\n        </div>\n    }\n}\n\nexport default TransferItem;","import React from 'react';\nimport TransferController from \"../TransferController\";\nimport TransferItem from \"./TransferItem\";\n\nimport Styles from \"./TransfersScreen.module.css\";\n\nclass TransfersScreen extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            jobs: []\n        };\n    }\n\n    componentDidMount() {\n        TransferController.on(\"progressUpdated\", this.progressUpdated.bind(this));\n\n        this.progressUpdated();\n    }\n\n    componentWillUnmount() {\n        TransferController.removeListener(\"progressUpdated\", this.progressUpdated.bind(this));\n    }\n\n    progressUpdated() {\n        this.setState({\n            jobs: [...TransferController.jobs()].reverse()\n        });\n    }\n\n    render() {\n        return <div className={Styles.TransferGrid}>\n            {this.state.jobs.map(job => <TransferItem job={job} />)}\n        </div>\n    }\n}\n\nexport default TransfersScreen;","import React from 'react';\n\nimport Styles from './UploadScreen.module.css';\n\nimport WsController from '../WsController'\n\nclass UploadScreen extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            isDropping: false\n        };\n\n        this.filePicker = React.createRef();\n    }\n\n    dragEnter(event) {\n        let types = event.dataTransfer.types;\n        if (!types.includes(\"Files\")) return;\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.setState({\n            isDropping: true\n        });\n    }\n\n    dragLeave(event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.setState({\n            isDropping: false\n        });\n    }\n\n    dragOver(event) {\n        event.preventDefault();\n        event.stopPropagation();\n    }\n\n    drop(event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        this.setState({\n            isDropping: false\n        });\n\n        let files;\n        if (event.dataTransfer.items) {\n            files = Array.from(event.dataTransfer.items).filter(item => item.kind === \"file\").map(item => item.getAsFile());\n        } else {\n            files = event.dataTransfer.files;\n        }\n\n        this.uploadFiles(files);\n    }\n\n    pickFileClicked() {\n        this.filePicker.current.click()\n    }\n\n    pickFile(event) {\n        this.uploadFiles(Array.from(event.target.files));\n        event.target.value = \"\";\n    }\n\n    uploadFiles(files) {\n        try {\n            const initialLength = files.length;\n            files = files.filter(file => [\"image/png\", \"image/jpeg\", \"image/gif\"].includes(file.type));\n            if (files.length === 0) throw new Error(\"Not a file!\");\n\n            if (files.length !== initialLength) {\n                //Let the user know that some files will not be uploaded\n            }\n    \n            console.log(`Uploading ${files.length} files.`)\n            for (let file of files) {\n                let reader = new FileReader();\n                reader.readAsDataURL(file);\n                reader.onloadend = () => {\n                    WsController.sendBase64Picture(reader.result);\n                };\n            }\n\n            this.props.onUploadSelected();\n        } catch (err) {\n            console.log(\"Not valid files\");\n        }\n    }\n\n    render() {\n        return <div className={[Styles.UploadScreen, this.state.isDropping ? Styles.Dropping : \"\"].filter(cls => cls !== \"\").join(\" \")}\n            onDragEnter={this.dragEnter.bind(this)}\n            onDragLeave={this.dragLeave.bind(this)}\n            onDragOver={this.dragOver.bind(this)}\n            onDrop={this.drop.bind(this)} >\n            <div className={Styles.UploadContainer}>\n                <h1>Upload a picture</h1>\n                Go ahead and drop a picture here to upload it.\n                <div className={Styles.UploadButton} onClick={this.pickFileClicked.bind(this)}>Pick File</div>\n                <input type=\"file\" multiple={true} onChange={this.pickFile.bind(this)} className={Styles.FilePicker} ref={this.filePicker} />\n            </div>\n        </div>\n    }\n}\n\nexport default UploadScreen;","import React from 'react';\n\nimport WsController from '../WsController'\n\nimport Header from './Header';\nimport CameraScreen from './CameraScreen';\nimport TransfersScreen from './TransfersScreen';\nimport UploadScreen from './UploadScreen';\n\nclass MainScreen extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            page: \"camera\"\n        }\n    }\n    \n    changePage(page) {\n        this.setState({\n            page: page\n        });\n    }\n    \n    exit() {\n        WsController.disconnect();\n    }\n    \n    render() {\n        return <div className=\"mainWrapper\">\n            <Header page={this.state.page} onChangePage={this.changePage.bind(this)} onExit={this.exit.bind(this)} />\n            {this.renderPage()}\n        </div>\n    }\n    \n    renderPage() {\n        switch (this.state.page) {\n            case \"camera\":\n                return <CameraScreen />\n            case \"transfers\":\n                return <TransfersScreen />\n            case \"upload\":\n                return <UploadScreen onUploadSelected={this.onUploadSelected.bind(this)}/>\n            default:\n                return <span>Please navigate to another page</span>\n        }\n    }\n\n    onUploadSelected() {\n        this.changePage(\"transfers\");\n    }\n}\n\nexport default MainScreen;","import React from 'react';\nimport './App.css';\n\nimport WsController from './WsController'\n\nimport Welcome from './welcome'\nimport MainScreen from './screens/MainScreen';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        WsController.setWsStateChangeHandler(() => {\n            this.setState({\n                isConnected: WsController.isConnected()\n            });\n        });\n        \n        this.state = {\n            isConnected: false\n        }\n    }\n    \n    renderMainPage() {\n        if (this.state.isConnected) {\n            return <MainScreen />\n        } else {\n            return <Welcome />\n        }\n    }\n    \n    render() {\n        return <div className=\"App\">\n            {this.renderMainPage()}\n        </div>\n    }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"CameraPage\":\"CameraScreen_CameraPage__2U6d4\",\"CameraError\":\"CameraScreen_CameraError__2Vc3i\",\"CameraErrorContainer\":\"CameraScreen_CameraErrorContainer__1nYUF\",\"CameraErrorGlyph\":\"CameraScreen_CameraErrorGlyph__3xVLf\",\"CameraWebcam\":\"CameraScreen_CameraWebcam__2BsjO\",\"CaptureButton\":\"CameraScreen_CaptureButton__goaOq\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"UploadScreen\":\"UploadScreen_UploadScreen__3pz85\",\"UploadContainer\":\"UploadScreen_UploadContainer__3HScZ\",\"UploadButton\":\"UploadScreen_UploadButton__x2Gln\",\"Dropping\":\"UploadScreen_Dropping__29LN2\",\"FilePicker\":\"UploadScreen_FilePicker__1tnTi\"};"],"sourceRoot":""}