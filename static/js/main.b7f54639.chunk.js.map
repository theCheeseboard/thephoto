{"version":3,"sources":["TransferController.js","WsController.js","welcome.jsx","screens/Header.jsx","screens/CameraHud.jsx","assets/camera-unavailable.svg","screens/CameraScreen.jsx","screens/MainScreen.jsx","App.jsx","reportWebVitals.js","index.js"],"names":["TransferJob","this","value","controller","handler","room","username","Promise","res","rej","wsUrl","process","WebSocket","onopen","event","sendMessage","type","msg","user","onerror","onclose","onmessage","wsMessage","bind","data","arrayBuffer","Response","decoder","TextDecoder","JSON","parse","decode","replyTo","message","replyHandler","seq","userId","payload","TextEncoder","encode","stringify","send","isConnected","close","picture","job","TransferController","makeTransferJob","setImageData","mimeType","substring","indexOf","substr","setTotal","length","sendChunk","replySeq","pictureData","progress","total","continue","addProgress","Welcome","props","state","error","WsController","connect","catch","setState","className","class","onChange","e","target","renderError","onClick","React","Component","Header","changePage","onExit","page","onChangePage","button","classes","push","join","CameraHud","onCapture","_extends","Object","assign","i","arguments","source","key","prototype","hasOwnProperty","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","_ref2","id","SvgCameraUnavailable","_ref","svgRef","title","titleId","width","height","viewBox","ref","transform","style","strokeWidth","fill","fillOpacity","color","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","lineHeight","fontFamily","fontVariantLigatures","fontVariantPosition","fontVariantCaps","fontVariantNumeric","fontVariantAlternates","fontFeatureSettings","textIndent","textAlign","textDecoration","textDecorationLine","textDecorationStyle","textDecorationColor","letterSpacing","wordSpacing","textTransform","writingMode","direction","textOrientation","dominantBaseline","baselineShift","textAnchor","whiteSpace","shapePadding","clipRule","display","overflow","visibility","opacity","isolation","mixBlendMode","colorInterpolation","colorInterpolationFilters","solidColor","solidOpacity","vectorEffect","fillRule","stroke","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeDasharray","strokeDashoffset","strokeOpacity","colorRendering","imageRendering","shapeRendering","textRendering","enableBackground","d","fontVariantEastAsian","fontVariationSettings","shapeMargin","inlineSize","stopColor","stopOpacity","ForwardRef","CameraScreen","webcam","createRef","errorState","videoConstraints","facingMode","frameRate","audio","onUserMedia","mediaStream","onUserMediaError","mediaError","screenshotFormat","capture","renderPage","console","log","name","current","getScreenshot","sendBase64Picture","MainScreen","disconnect","exit","App","setWsStateChangeHandler","renderMainPage","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b7f54639.chunk.js","sourcesContent":["class TransferJob {\n    #progress;\n    #total;\n    #imageData;\n    \n    constructor() {\n        this.#progress = 0;\n        this.#total = 0;\n    }\n    \n    setProgress(value) {\n        this.#progress = value;\n    }\n    \n    addProgress(value) {\n        this.#progress += value;\n    }\n    \n    setTotal(value) {\n        this.#total = value;\n    }\n    \n    setImageData(value) {\n        this.#imageData = value;\n    }\n    \n    progress() {\n        return this.#progress;\n    }\n    \n    total() {\n        return this.#total;\n    }\n}\n\nclass TransferController {\n    makeTransferJob() {\n        let job = new TransferJob();\n        return job;\n    }\n}\n\nlet controller = new TransferController();\nexport default controller;","import TransferController from './TransferController';\n\nclass WsController {\n    #ws;\n    #username;\n    #wsStateChangeHandler;\n    #connected;\n    #userId;\n    \n    #seq;\n    #replies;\n    \n    constructor() {\n        this.#ws = null;\n        this.#seq = 0;\n        this.#replies = {};\n    }\n    \n    setWsStateChangeHandler(handler) {\n        this.#wsStateChangeHandler = handler;\n    }\n    \n    connect(room, username) {\n        return new Promise((res, rej) => {\n            // let wsUrl = \"ws://\" + room + \":26158/\";\n            let wsUrl = `${process.env.REACT_APP_RENDEZVOUS_SERVER}/rendezvous/${room}`\n            this.#ws = new WebSocket(wsUrl);\n            this.#ws.onopen = (event) => {\n                this.sendMessage({\n                    type: \"connect\",\n                    username: username\n                }, (msg) => {\n                    this.#connected = true;\n                    this.#userId = msg.user;\n                    this.#wsStateChangeHandler();\n                    res();\n                });\n            };\n            this.#ws.onerror = (event) => {\n                this.#ws = null;\n                this.#connected = false;\n                \n                this.#wsStateChangeHandler();\n                rej();\n            }\n            this.#ws.onclose = (event) => {\n                this.#ws = null;\n                this.#connected = false;\n                this.#userId = null;\n                this.#wsStateChangeHandler();\n            }\n            this.#ws.onmessage = this.wsMessage.bind(this);\n        });\n    }\n    \n    async wsMessage(event) {\n        let data;\n        if (event.data.arrayBuffer) {\n            data = await event.data.arrayBuffer();\n        } else {\n            data = await new Response(event.data).arrayBuffer();\n        }\n        \n        //TODO: decrypt data\n        \n        let decoder = new TextDecoder(\"utf-8\");\n        let msg = JSON.parse(decoder.decode(data));\n        \n        if (msg.replyTo !== null) {\n            this.#replies[msg.replyTo](msg);\n        }\n    }\n    \n    isConnected() {\n        return this.#connected;\n    }\n    \n    sendMessage(message, replyHandler) {\n        message.seq = this.#seq++;\n        \n        if (this.#userId !== null) {\n            message.userId = this.#userId;\n        }\n        \n        let textEncoder = new TextEncoder();\n        let payload = textEncoder.encode(JSON.stringify(message));\n        \n        //TODO: encrypt payload\n        \n        this.#ws.send(payload);\n        \n        if (replyHandler !== null) {\n            this.#replies[message.seq] = replyHandler;\n        }\n        \n        return message.seq;\n    }\n    \n    disconnect() {\n        if (this.isConnected()) {\n            this.sendMessage({\n                type: \"disconnect\",\n                userId: this.#userId\n            }, () => this.#ws.close.bind(this));\n        }\n        this.#ws.close();\n    }\n    \n    sendBase64Picture(picture) {\n        let job = TransferController.makeTransferJob();\n        job.setImageData(picture);\n        \n        let mimeType = picture.substring(5, picture.indexOf(\";\"));\n        \n        picture = picture.substr(picture.indexOf(\"base64,\") + 7);\n        job.setTotal(picture.length);\n        \n        //Send the picture 4096 chunks at a time\n        let sendChunk = (replySeq) => {\n            let pictureData = picture.substr(job.progress(), 4096);\n            let message = {\n                type: \"picture\",\n                length: picture.length,\n                mimeType: mimeType,\n                data: pictureData\n            };\n            \n            if (replySeq !== null) {\n                message.replyTo = replySeq;\n            }\n            \n            this.sendMessage(message, (data) => {\n                if (job.progress() >= job.total()) {\n                    //We're done here\n                    //TODO: change the state of the transfer\n                } else {\n                    if (data.continue) sendChunk(data.replyTo);\n                }\n            });\n            job.addProgress(pictureData.length);\n        };\n        \n        sendChunk();\n    }\n}\n\nlet controller = new WsController();\n\nexport default controller;","import React from 'react';\n\nimport WsController from './WsController'\n\nclass Welcome extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            room: \"\",\n            username: \"\",\n            error: \"\"\n        }\n    }\n    \n    connect() {\n        if (this.state.username === \"\") {\n            this.setState({\n                error: \"Enter a username\"\n            });\n            return;\n        }\n        \n        WsController.connect(this.state.room, this.state.username).catch((error) => {\n            this.setState({\n                error: \"Check the room code and try again\"\n            });\n            return;\n        });\n    }\n    \n    renderError() {\n        if (this.state.error === \"\") return null;\n        return <span className=\"error\">{this.state.error}</span>\n    }\n    \n    render() {\n        return <div className=\"welcomeWrapper\">\n            <div className=\"welcomeContainer\">\n                <h1>Welcome to thePhoto</h1>\n                <p>For the best experience, grab the app:</p>\n                <hr />\n                <h2>Connect</h2>\n                <p>You can also connect using your web browser.</p>\n                \n                <div class=\"welcomeForm\">\n                    <span>Room</span>\n                    <input type=\"text\" value={this.state.room} onChange={(e => this.setState({room: e.target.value}))}/>\n                    \n                    <span>Username</span>\n                    <input type=\"text\" value={this.state.username} onChange={(e => this.setState({username: e.target.value}))}/>\n                    \n                    {this.renderError()}\n                    <button onClick={this.connect.bind(this)}>Connect</button>\n                </div>\n            </div>\n        </div>\n    }\n}\n\nexport default Welcome;","import React from 'react';\n\nclass Header extends React.Component {\n    render() {\n        return <div className=\"header\">\n            <div className=\"systemButton menu\" />\n            <div className={this.className(\"camera\")} onClick={() => this.changePage(\"camera\")}>Camera</div>\n            <div className={this.className(\"transfers\")} onClick={() => this.changePage(\"transfers\")}>Transfers</div>\n            <div className={this.className(\"upload\")} onClick={() => this.changePage(\"upload\")}>Upload</div>\n            <div className=\"spacer\" />\n            <div className=\"systemButton close\" onClick={this.props.onExit} />\n        </div>;\n    }\n    \n    changePage(page) {\n        this.props.onChangePage(page);\n    }\n    \n    className(button) {\n        let classes = [\"headerButton\", button];\n        if (this.props.page === button) classes.push(\"selected\");\n        return classes.join(\" \");\n    }\n}\n\nexport default Header;","import React from 'react';\n\nclass CameraHud extends React.Component {\n    render() {\n        return <div className=\"cameraHud\">\n            <div className=\"captureButton\" onClick={this.props.onCapture}/>\n        </div>\n    }\n}\n\nexport default CameraHud;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"defs\", {\n  id: \"defs2\"\n});\n\nfunction SvgCameraUnavailable(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    width: 128,\n    height: 128,\n    viewBox: \"0 0 33.866666 33.866668\",\n    id: \"svg8\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"layer1\"\n  }, /*#__PURE__*/React.createElement(\"g\", {\n    id: \"g855\",\n    transform: \"matrix(6.8558595,0,0,6.8547919,-93.717829,-100.95504)\",\n    style: {\n      strokeWidth: 0.145872,\n      fill: \"#000000\",\n      fillOpacity: 0.5\n    }\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    id: \"rect841-6\",\n    style: {\n      color: \"#000000\",\n      fontStyle: \"normal\",\n      fontVariant: \"normal\",\n      fontWeight: \"normal\",\n      fontStretch: \"normal\",\n      fontSize: \"medium\",\n      lineHeight: \"normal\",\n      fontFamily: \"sans-serif\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontFeatureSettings: \"normal\",\n      textIndent: 0,\n      textAlign: \"start\",\n      textDecoration: \"none\",\n      textDecorationLine: \"none\",\n      textDecorationStyle: \"solid\",\n      textDecorationColor: \"#000000\",\n      letterSpacing: \"normal\",\n      wordSpacing: \"normal\",\n      textTransform: \"none\",\n      writingMode: \"lr-tb\",\n      direction: \"ltr\",\n      textOrientation: \"mixed\",\n      dominantBaseline: \"auto\",\n      baselineShift: \"baseline\",\n      textAnchor: \"start\",\n      whiteSpace: \"normal\",\n      shapePadding: 0,\n      clipRule: \"nonzero\",\n      display: \"inline\",\n      overflow: \"visible\",\n      visibility: \"visible\",\n      opacity: 1,\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      colorInterpolation: \"sRGB\",\n      colorInterpolationFilters: \"linearRGB\",\n      solidColor: \"#000000\",\n      solidOpacity: 1,\n      vectorEffect: \"none\",\n      fill: \"#000000\",\n      fillOpacity: 0.5,\n      fillRule: \"nonzero\",\n      stroke: \"none\",\n      strokeWidth: 0.0385953,\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 4,\n      strokeDasharray: \"none\",\n      strokeDashoffset: 0,\n      strokeOpacity: 1,\n      colorRendering: \"auto\",\n      imageRendering: \"auto\",\n      shapeRendering: \"auto\",\n      textRendering: \"auto\",\n      enableBackground: \"accumulate\"\n    },\n    d: \"m 15.610417,16.139584 c -0.265508,0 -0.505815,0.102097 -0.691948,0.264583 H 14.419792 A 0.1323049,0.1323049 0 0 0 14.2875,16.536459 v 1.322916 a 0.1323049,0.1323049 0 0 0 0.132292,0.132292 h 0.364835 l 0.249597,-0.249597 c -0.134065,-0.141993 -0.217557,-0.332417 -0.217557,-0.544153 0,-0.439943 0.353807,-0.79375 0.79375,-0.79375 0.211735,0 0.40216,0.08349 0.544152,0.217558 l 0.217558,-0.217558 h -0.06976 c -0.186133,-0.162486 -0.42644,-0.264583 -0.691947,-0.264583 z m 2.092378,0.05633 -0.472839,0.472839 h 0.364836 a 0.1323049,0.1323049 0 0 1 0.132291,0.132292 v 0.264583 a 0.1323049,0.1323049 0 0 1 -0.132291,0.132292 h -0.529167 a 0.1323049,0.1323049 0 0 1 -0.132292,-0.132292 v -0.100252 l -0.649572,0.649573 c -0.06458,0.104391 -0.151924,0.191739 -0.256316,0.256315 l -0.381372,0.381372 c 0.251017,-0.0089 0.478725,-0.105959 0.656291,-0.260966 h 1.557011 a 0.1323049,0.1323049 0 0 0 0.132292,-0.132292 V 16.536462 A 0.1323049,0.1323049 0 0 0 17.859375,16.40417 h -0.132292 v -0.132292 a 0.1323049,0.1323049 0 0 0 -0.02429,-0.07596 z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    style: {\n      color: \"#000000\",\n      fontStyle: \"normal\",\n      fontVariant: \"normal\",\n      fontWeight: \"normal\",\n      fontStretch: \"normal\",\n      fontSize: \"medium\",\n      lineHeight: \"normal\",\n      fontFamily: \"sans-serif\",\n      fontVariantLigatures: \"normal\",\n      fontVariantPosition: \"normal\",\n      fontVariantCaps: \"normal\",\n      fontVariantNumeric: \"normal\",\n      fontVariantAlternates: \"normal\",\n      fontVariantEastAsian: \"normal\",\n      fontFeatureSettings: \"normal\",\n      fontVariationSettings: \"normal\",\n      textIndent: 0,\n      textAlign: \"start\",\n      textDecoration: \"none\",\n      textDecorationLine: \"none\",\n      textDecorationStyle: \"solid\",\n      textDecorationColor: \"#000000\",\n      letterSpacing: \"normal\",\n      wordSpacing: \"normal\",\n      textTransform: \"none\",\n      writingMode: \"lr-tb\",\n      direction: \"ltr\",\n      textOrientation: \"mixed\",\n      dominantBaseline: \"auto\",\n      baselineShift: \"baseline\",\n      textAnchor: \"start\",\n      whiteSpace: \"normal\",\n      shapePadding: 0,\n      shapeMargin: 0,\n      inlineSize: 0,\n      clipRule: \"nonzero\",\n      display: \"inline\",\n      overflow: \"visible\",\n      visibility: \"visible\",\n      opacity: 1,\n      isolation: \"auto\",\n      mixBlendMode: \"normal\",\n      colorInterpolation: \"sRGB\",\n      colorInterpolationFilters: \"linearRGB\",\n      solidColor: \"#000000\",\n      solidOpacity: 1,\n      vectorEffect: \"none\",\n      fill: \"#000000\",\n      fillOpacity: 0.5,\n      fillRule: \"nonzero\",\n      stroke: \"none\",\n      strokeWidth: \"0.0385953px\",\n      strokeLinecap: \"round\",\n      strokeLinejoin: \"round\",\n      strokeMiterlimit: 4,\n      strokeDasharray: \"none\",\n      strokeDashoffset: 0,\n      strokeOpacity: 1,\n      colorRendering: \"auto\",\n      imageRendering: \"auto\",\n      shapeRendering: \"auto\",\n      textRendering: \"auto\",\n      enableBackground: \"accumulate\",\n      stopColor: \"#000000\",\n      stopOpacity: 1\n    },\n    d: \"m 17.871094,15.345703 a 0.1322915,0.1322915 0 0 0 -0.105469,0.03906 l -3.439453,3.439453 a 0.1322915,0.1322915 0 0 0 0,0.1875 0.1322915,0.1322915 0 0 0 0.1875,0 l 3.439453,-3.439453 a 0.1322915,0.1322915 0 0 0 0,-0.1875 0.1322915,0.1322915 0 0 0 -0.08203,-0.03906 z\",\n    id: \"path859\"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCameraUnavailable);\nexport default __webpack_public_path__ + \"static/media/camera-unavailable.4ef8fb1c.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\n\nimport CameraHud from './CameraHud';\nimport Webcam from \"react-webcam\";\nimport { ReactComponent as CameraUnavailable } from \"../assets/camera-unavailable.svg\";\n\nimport WsController from '../WsController'\n\nclass CameraScreen extends React.Component {\n    webcam;\n    \n    constructor(props) {\n        super(props);\n        \n        this.webcam = React.createRef();\n        \n        this.state = {\n            errorState: \"noError\",\n            videoConstraints: {\n                facingMode: \"environment\",\n                width: 4096,\n                height: 2160,\n                frameRate: 60\n            }\n        }\n    }\n    \n    renderPage() {\n        switch (this.state.errorState) {\n            case \"noError\":\n                return [\n                    <Webcam\n                        key=\"webcam\"\n                        audio={false}\n                        ref={this.webcam}\n                        onUserMedia={this.mediaStream.bind(this)}\n                        onUserMediaError={this.mediaError.bind(this)}\n                        videoConstraints={this.state.videoConstraints}\n                        screenshotFormat=\"image/png\"\n                        className=\"cameraWebcam\" />,\n                    <CameraHud\n                        key=\"webcamHud\"\n                        onCapture={this.capture.bind(this)} />\n                ]\n            case \"noCamera\":\n                return <div className=\"cameraError\">\n                    <div className=\"cameraErrorContainer\">\n                        <CameraUnavailable className=\"cameraErrorGlyph\" />\n                        <h1>There is no camera on this device.</h1>\n                    </div>\n                </div>\n            case \"noSupport\":\n                return <div className=\"cameraError\">\n                    <div className=\"cameraErrorContainer\">\n                        <CameraUnavailable className=\"cameraErrorGlyph\" />\n                        <h1>This browser is unsupported</h1>\n                        <div>\n                            <p>Use a browser that can access the camera. Possible options are:</p>\n                            <ul>\n                                <li>Google Chrome</li>\n                                <li>Firefox</li>\n                                <li>Safari</li>\n                                <li>Microsoft Edge</li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            case \"noPermission\":\n                return <div className=\"cameraError\">\n                    <div className=\"cameraErrorContainer\">\n                        <CameraUnavailable className=\"cameraErrorGlyph\" />\n                        <h1>Can't access the camera</h1>\n                        <div>\n                            <p>Check the permissions for this page, and then reload the page to try again.</p>\n                        </div>\n                    </div>\n                </div>\n            case \"genericError\":\n            default:\n                return <div className=\"cameraError\">\n                    <div className=\"cameraErrorContainer\">\n                        <CameraUnavailable className=\"cameraErrorGlyph\" />\n                        <h1>Can't access the camera</h1>\n                    </div>\n                </div>\n        }\n    }\n    \n    render() {\n        return <div className=\"cameraPage\">\n            {this.renderPage()}\n        </div>\n    }\n    \n    mediaStream(event) {\n        console.log(event);\n    }\n    \n    mediaError(error) {\n        console.log(error);\n        if (error.message === \"getUserMedia is not implemented in this browser\") {\n                this.setState({\n                    errorState: \"noSupport\"\n                });\n            return;\n        }\n        \n        switch (error.name) {\n            case \"NotFoundError\":\n                this.setState({\n                    errorState: \"noCamera\"\n                });\n                break;\n            case \"NotAllowedError\":\n                this.setState({\n                    errorState: \"noPermission\"\n                });\n                break;\n            default:\n                this.setState({\n                    errorState: \"genericError\"\n                });\n                break;\n        }\n    }\n    \n    capture() {\n        let picture = this.webcam.current.getScreenshot();\n        WsController.sendBase64Picture(picture);\n    }\n}\n\nexport default CameraScreen;","import React from 'react';\n\nimport WsController from '../WsController'\n\nimport Header from './Header';\nimport CameraScreen from './CameraScreen';\n\nclass MainScreen extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        this.state = {\n            page: \"camera\"\n        }\n    }\n    \n    changePage(page) {\n        this.setState({\n            page: page\n        });\n    }\n    \n    exit() {\n        WsController.disconnect();\n    }\n    \n    render() {\n        return <div className=\"mainWrapper\">\n            <Header page={this.state.page} onChangePage={this.changePage.bind(this)} onExit={this.exit.bind(this)} />\n            {this.renderPage()}\n        </div>\n    }\n    \n    renderPage() {\n        switch (this.state.page) {\n            case \"camera\":\n                return <CameraScreen />\n            case \"transfers\":\n                return <span>This is the Transfers page</span>\n            case \"upload\":\n                return <span>This is the Upload page</span>\n            default:\n                return <span>Please navigate to another page</span>\n        }\n    }\n}\n\nexport default MainScreen;","import React from 'react';\nimport './App.css';\n\nimport WsController from './WsController'\n\nimport Welcome from './welcome'\nimport MainScreen from './screens/MainScreen';\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        \n        WsController.setWsStateChangeHandler(() => {\n            this.setState({\n                isConnected: WsController.isConnected()\n            });\n        });\n        \n        this.state = {\n            isConnected: false\n        }\n    }\n    \n    renderMainPage() {\n        if (this.state.isConnected) {\n            return <MainScreen />\n        } else {\n            return <Welcome />\n        }\n    }\n    \n    render() {\n        return <div className=\"App\">\n            {this.renderMainPage()}\n        </div>\n    }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}