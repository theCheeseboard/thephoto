(this["webpackJsonpthephoto-react"]=this["webpackJsonpthephoto-react"]||[]).push([[0],{10:function(e,t,r){e.exports={UploadScreen:"UploadScreen_UploadScreen__3pz85",UploadContainer:"UploadScreen_UploadContainer__3HScZ",UploadButton:"UploadScreen_UploadButton__x2Gln",Dropping:"UploadScreen_Dropping__29LN2",FilePicker:"UploadScreen_FilePicker__1tnTi"}},16:function(e,t,r){e.exports={CameraHud:"CameraHud_CameraHud__NBjqx",CaptureButton:"CameraHud_CaptureButton__1t8n5",CaptureButtonInnerCircle:"CameraHud_CaptureButtonInnerCircle__6jy9s"}},18:function(e,t,r){e.exports={TransferItem:"TransferItem_TransferItem__3io49"}},22:function(e,t,r){e.exports={TransferGrid:"TransfersScreen_TransferGrid__Jhz2X"}},28:function(e,t,r){},29:function(e,t,r){},32:function(e,t,r){"use strict";r.r(t);var a,n,i=r(2),s=r.n(i),o=r(19),c=r.n(o),l=(r(28),r(3)),u=r(4),d=r(6),h=r(5),p=(r(29),r(9)),b=r.n(p),f=r(15),j=r(13),m=r(1),O=r(7),v=r(11),g=r(20),y=r.n(g),x=Object(O.a)("progress"),k=Object(O.a)("total"),C=Object(O.a)("imageData"),w=function(){function e(){Object(l.a)(this,e),Object.defineProperty(this,x,{writable:!0,value:void 0}),Object.defineProperty(this,k,{writable:!0,value:void 0}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object(m.a)(this,x)[x]=0,Object(m.a)(this,k)[k]=0}return Object(u.a)(e,[{key:"setProgress",value:function(e){Object(m.a)(this,x)[x]=e,a.emit("progressUpdated")}},{key:"addProgress",value:function(e){Object(m.a)(this,x)[x]+=e,a.emit("progressUpdated")}},{key:"setTotal",value:function(e){Object(m.a)(this,k)[k]=e,a.emit("progressUpdated")}},{key:"setImageData",value:function(e){Object(m.a)(this,C)[C]=e}},{key:"imageData",value:function(){return Object(m.a)(this,C)[C]}},{key:"progress",value:function(){return Object(m.a)(this,x)[x]}},{key:"total",value:function(){return Object(m.a)(this,k)[k]}},{key:"percentComplete",value:function(){return Object(m.a)(this,x)[x]/Object(m.a)(this,k)[k]}}]),e}(),S=Object(O.a)("jobs"),P=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(){var e;return Object(l.a)(this,r),e=t.call(this),Object.defineProperty(Object(v.a)(e),S,{writable:!0,value:void 0}),Object(m.a)(Object(v.a)(e),S)[S]=[],e}return Object(u.a)(r,[{key:"makeTransferJob",value:function(){var e=new w;return Object(m.a)(this,S)[S].push(e),e}},{key:"jobs",value:function(){return Object(m.a)(this,S)[S]}}]),r}(y.a),E=a=new P,N=Object(O.a)("ws"),_=Object(O.a)("username"),B=Object(O.a)("wsStateChangeHandler"),U=Object(O.a)("connected"),A=Object(O.a)("userId"),T=Object(O.a)("pk"),D=Object(O.a)("symk"),I=Object(O.a)("seq"),F=Object(O.a)("replies"),M=function(){function e(){Object(l.a)(this,e),Object.defineProperty(this,N,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,B,{writable:!0,value:void 0}),Object.defineProperty(this,U,{writable:!0,value:void 0}),Object.defineProperty(this,A,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,D,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),Object(m.a)(this,N)[N]=null,Object(m.a)(this,I)[I]=0,Object(m.a)(this,F)[F]={}}return Object(u.a)(e,[{key:"setWsStateChangeHandler",value:function(e){Object(m.a)(this,B)[B]=e}},{key:"stringToBuf",value:function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0,n=e.length;a<n;a++)r[a]=e.charCodeAt(a);return t}},{key:"connect",value:function(e,t,r){var a=this;return new Promise(function(){var n=Object(j.a)(b.a.mark((function n(i,s){var o,c,l,u,d,h,p,O,v;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("".concat("https://").concat("thephoto-rendezvous.vicr123.com","/keys/").concat(e));case 3:return o=n.sent,n.next=6,crypto.subtle.importKey("raw",a.stringToBuf(r),{name:"HMAC",hash:"SHA-512"},!1,["verify"]);case 6:return c=n.sent,l=o.headers.get("X-thePhoto-HMAC"),n.next=10,o.arrayBuffer();case 10:return u=n.sent,n.next=13,crypto.subtle.verify("HMAC",c,a.stringToBuf(window.atob(l)),u);case 13:if(n.sent){n.next=16;break}return s(),n.abrupt("return");case 16:return d=new TextDecoder("utf-8").decode(u),"-----BEGIN PRIVATE KEY-----","-----END PRIVATE KEY-----",h=d.substring("-----BEGIN PRIVATE KEY-----".length,d.length-"-----END PRIVATE KEY-----".length),p=window.atob(h),O=a.stringToBuf(p),n.next=24,crypto.subtle.importKey("spki",O,{name:"RSA-OAEP",hash:"SHA-1"},!1,["encrypt"]);case 24:Object(m.a)(a,T)[T]=n.sent,n.next=32;break;case 27:return n.prev=27,n.t0=n.catch(0),console.log(n.t0),s(n.t0),n.abrupt("return");case 32:return n.next=34,crypto.subtle.generateKey({name:"AES-CBC",length:256},!0,["encrypt","decrypt"]);case 34:Object(m.a)(a,D)[D]=n.sent,v="".concat("wss://").concat("thephoto-rendezvous.vicr123.com","/rendezvous/").concat(e),Object(m.a)(a,N)[N]=new WebSocket(v),Object(m.a)(a,N)[N].onopen=function(){var e=Object(j.a)(b.a.mark((function e(r){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.exportKey("raw",Object(m.a)(a,D)[D]);case 2:return n=e.sent,e.next=5,a.sendMessage({type:"connect",username:t,key:btoa(String.fromCharCode.apply(String,Object(f.a)(new Uint8Array(n))))},(function(e){Object(m.a)(a,U)[U]=!0,Object(m.a)(a,A)[A]=e.user,Object(m.a)(a,B)[B](),i()}),!0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(m.a)(a,N)[N].onerror=function(e){Object(m.a)(a,N)[N]=null,Object(m.a)(a,U)[U]=!1,Object(m.a)(a,B)[B](),s()},Object(m.a)(a,N)[N].onclose=function(e){Object(m.a)(a,N)[N]=null,Object(m.a)(a,U)[U]=!1,Object(m.a)(a,A)[A]=null,Object(m.a)(a,B)[B]()},Object(m.a)(a,N)[N].onmessage=a.wsMessage.bind(a);case 41:case"end":return n.stop()}}),n,null,[[0,27]])})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"wsMessage",value:function(){var e=Object(j.a)(b.a.mark((function e(t){var r,a,n,i,s,o,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.data.arrayBuffer){e.next=6;break}return e.next=3,t.data.arrayBuffer();case 3:r=e.sent,e.next=9;break;case 6:return e.next=8,new Response(t.data).arrayBuffer();case 8:r=e.sent;case 9:if(a=new Uint8Array(r),"E"!==String.fromCharCode(a[0])){e.next=17;break}return n=a[1],i=a.slice(2,2+n),s=a.slice(2+n),e.next=16,crypto.subtle.decrypt({name:"AES-CBC",iv:i},Object(m.a)(this,D)[D],s);case 16:r=e.sent;case 17:if(o=new TextDecoder("utf-8"),"serverKeepalive"!==(c=JSON.parse(o.decode(r))).type){e.next=21;break}return e.abrupt("return");case 21:null!==c.replyTo&&Object(m.a)(this,F)[F][c.replyTo](c);case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isConnected",value:function(){return Object(m.a)(this,U)[U]}},{key:"sendMessage",value:function(){var e=Object(j.a)(b.a.mark((function e(t,r,a){var n,i,s,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.seq=Object(m.a)(this,I)[I]++,null!==Object(m.a)(this,A)[A]&&(t.userId=Object(m.a)(this,A)[A]),n=new TextEncoder,i=n.encode(JSON.stringify(t)),!a){e.next=17;break}return e.prev=5,e.next=8,crypto.subtle.encrypt({name:"RSA-OAEP"},Object(m.a)(this,T)[T],i);case 8:i=e.sent,e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(5),console.log(e.t0),e.abrupt("return");case 15:e.next=32;break;case 17:return e.prev=17,s=crypto.getRandomValues(new Uint8Array(16)),e.next=21,crypto.subtle.encrypt({name:"AES-CBC",iv:s},Object(m.a)(this,D)[D],i);case 21:o=e.sent,(i=new Uint8Array(2+s.length+o.byteLength)).set(["E".charCodeAt(0),s.length]),i.set(s,2),i.set(new Uint8Array(o),s.length+2),e.next=32;break;case 28:return e.prev=28,e.t1=e.catch(17),console.log(e.t1),e.abrupt("return");case 32:return Object(m.a)(this,N)[N].send(i),null!==r&&(Object(m.a)(this,F)[F][t.seq]=r),e.abrupt("return",t.seq);case 35:case"end":return e.stop()}}),e,this,[[5,11],[17,28]])})));return function(t,r,a){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=this;this.isConnected()&&this.sendMessage({type:"disconnect",userId:Object(m.a)(this,A)[A]},(function(){return Object(m.a)(e,N)[N].close.bind(e)})),Object(m.a)(this,N)[N].close()}},{key:"sendBase64Picture",value:function(e){var t=this,r=E.makeTransferJob();r.setImageData(e);var a=e.substring(5,e.indexOf(";"));e=e.substr(e.indexOf("base64,")+7),r.setTotal(e.length);!function n(i){var s=e.substr(r.progress(),131072),o={type:"picture",length:e.length,mimeType:a,data:s};null!==i&&(o.replyTo=i),t.sendMessage(o,(function(e){r.progress()>=r.total()||e.continue&&n(e.seq)})),r.addProgress(s.length)}()}}]),e}(),R=new M,V=r(0),L=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).state={room:window.localStorage.getItem("room")||"",username:window.localStorage.getItem("username")||"",error:""},a}return Object(u.a)(r,[{key:"connect",value:function(){var e=this;if(""!==this.state.username){var t=this.state.room.substr(0,4),r=this.state.room.substr(4);R.connect(t,this.state.username,r).catch((function(t){e.setState({error:"Check the room code and try again"})}))}else this.setState({error:"Enter a username"})}},{key:"renderError",value:function(){return""===this.state.error?null:Object(V.jsx)("span",{className:"error",children:this.state.error})}},{key:"render",value:function(){var e=this;return Object(V.jsx)("div",{className:"welcomeWrapper",children:Object(V.jsxs)("div",{className:"welcomeContainer",children:[Object(V.jsx)("h1",{children:"Welcome to thePhoto"}),Object(V.jsx)("p",{children:"For the best experience, grab the app:"}),Object(V.jsx)("hr",{}),Object(V.jsx)("h2",{children:"Connect"}),Object(V.jsx)("p",{children:"You can also connect using your web browser."}),Object(V.jsxs)("div",{className:"welcomeForm",children:[Object(V.jsx)("span",{children:"Room"}),Object(V.jsx)("input",{type:"text",value:this.state.room,onChange:function(t){window.localStorage.setItem("room",t.target.value),e.setState({room:t.target.value})}}),Object(V.jsx)("span",{children:"Username"}),Object(V.jsx)("input",{type:"text",value:this.state.username,onChange:function(t){window.localStorage.setItem("username",t.target.value),e.setState({username:t.target.value})}}),this.renderError(),Object(V.jsx)("button",{onClick:this.connect.bind(this),children:"Connect"})]})]})})}}]),r}(s.a.Component),W=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(){return Object(l.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){var e=this;return Object(V.jsxs)("div",{className:"header",children:[Object(V.jsx)("div",{className:"systemButton menu"}),Object(V.jsx)("div",{className:this.className("camera"),onClick:function(){return e.changePage("camera")},children:"Camera"}),Object(V.jsx)("div",{className:this.className("transfers"),onClick:function(){return e.changePage("transfers")},children:"Transfers"}),Object(V.jsx)("div",{className:this.className("upload"),onClick:function(){return e.changePage("upload")},children:"Upload"}),Object(V.jsx)("div",{className:"spacer"}),Object(V.jsx)("div",{className:"systemButton close",onClick:this.props.onExit})]})}},{key:"changePage",value:function(e){this.props.onChangePage(e)}},{key:"className",value:function(e){var t=["headerButton",e];return this.props.page===e&&t.push("selected"),t.join(" ")}}]),r}(s.a.Component),G=W,H=r(16),z=r.n(H),K=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(){return Object(l.a)(this,r),t.apply(this,arguments)}return Object(u.a)(r,[{key:"render",value:function(){return Object(V.jsx)("div",{className:z.a.CameraHud,children:Object(V.jsx)("div",{className:z.a.CaptureButton,onClick:this.props.onCapture,children:Object(V.jsxs)("svg",{width:100,height:100,children:[Object(V.jsx)("circle",{fill:"#00000000",stroke:"#ffffff",cx:50,cy:50,r:45,strokeWidth:5}),Object(V.jsx)("circle",{className:z.a.CaptureButtonInnerCircle})]})})})}}]),r}(s.a.Component),q=K,J=r(21),Y=r.n(J),X=["title","titleId"];function Z(){return Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Z.apply(this,arguments)}function Q(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function $(e,t){var r=e.title,a=e.titleId,s=Q(e,X);return i.createElement("svg",Z({width:128,height:128,viewBox:"0 0 33.866666 33.866668",id:"svg8",ref:t,"aria-labelledby":a},s),r?i.createElement("title",{id:a},r):null,n||(n=i.createElement("defs",{id:"defs2"})),i.createElement("g",{id:"layer1"},i.createElement("g",{id:"g855",transform:"matrix(6.8558595,0,0,6.8547919,-93.717829,-100.95504)",style:{strokeWidth:.145872,fill:"#000000",fillOpacity:.5}},i.createElement("path",{id:"rect841-6",style:{color:"#000000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:"medium",lineHeight:"normal",fontFamily:"sans-serif",fontVariantLigatures:"normal",fontVariantPosition:"normal",fontVariantCaps:"normal",fontVariantNumeric:"normal",fontVariantAlternates:"normal",fontFeatureSettings:"normal",textIndent:0,textAlign:"start",textDecoration:"none",textDecorationLine:"none",textDecorationStyle:"solid",textDecorationColor:"#000000",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",writingMode:"lr-tb",direction:"ltr",textOrientation:"mixed",dominantBaseline:"auto",baselineShift:"baseline",textAnchor:"start",whiteSpace:"normal",shapePadding:0,clipRule:"nonzero",display:"inline",overflow:"visible",visibility:"visible",opacity:1,isolation:"auto",mixBlendMode:"normal",colorInterpolation:"sRGB",colorInterpolationFilters:"linearRGB",solidColor:"#000000",solidOpacity:1,vectorEffect:"none",fill:"#000000",fillOpacity:.5,fillRule:"nonzero",stroke:"none",strokeWidth:.0385953,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1,colorRendering:"auto",imageRendering:"auto",shapeRendering:"auto",textRendering:"auto",enableBackground:"accumulate"},d:"m 15.610417,16.139584 c -0.265508,0 -0.505815,0.102097 -0.691948,0.264583 H 14.419792 A 0.1323049,0.1323049 0 0 0 14.2875,16.536459 v 1.322916 a 0.1323049,0.1323049 0 0 0 0.132292,0.132292 h 0.364835 l 0.249597,-0.249597 c -0.134065,-0.141993 -0.217557,-0.332417 -0.217557,-0.544153 0,-0.439943 0.353807,-0.79375 0.79375,-0.79375 0.211735,0 0.40216,0.08349 0.544152,0.217558 l 0.217558,-0.217558 h -0.06976 c -0.186133,-0.162486 -0.42644,-0.264583 -0.691947,-0.264583 z m 2.092378,0.05633 -0.472839,0.472839 h 0.364836 a 0.1323049,0.1323049 0 0 1 0.132291,0.132292 v 0.264583 a 0.1323049,0.1323049 0 0 1 -0.132291,0.132292 h -0.529167 a 0.1323049,0.1323049 0 0 1 -0.132292,-0.132292 v -0.100252 l -0.649572,0.649573 c -0.06458,0.104391 -0.151924,0.191739 -0.256316,0.256315 l -0.381372,0.381372 c 0.251017,-0.0089 0.478725,-0.105959 0.656291,-0.260966 h 1.557011 a 0.1323049,0.1323049 0 0 0 0.132292,-0.132292 V 16.536462 A 0.1323049,0.1323049 0 0 0 17.859375,16.40417 h -0.132292 v -0.132292 a 0.1323049,0.1323049 0 0 0 -0.02429,-0.07596 z"}),i.createElement("path",{style:{color:"#000000",fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:"medium",lineHeight:"normal",fontFamily:"sans-serif",fontVariantLigatures:"normal",fontVariantPosition:"normal",fontVariantCaps:"normal",fontVariantNumeric:"normal",fontVariantAlternates:"normal",fontVariantEastAsian:"normal",fontFeatureSettings:"normal",fontVariationSettings:"normal",textIndent:0,textAlign:"start",textDecoration:"none",textDecorationLine:"none",textDecorationStyle:"solid",textDecorationColor:"#000000",letterSpacing:"normal",wordSpacing:"normal",textTransform:"none",writingMode:"lr-tb",direction:"ltr",textOrientation:"mixed",dominantBaseline:"auto",baselineShift:"baseline",textAnchor:"start",whiteSpace:"normal",shapePadding:0,shapeMargin:0,inlineSize:0,clipRule:"nonzero",display:"inline",overflow:"visible",visibility:"visible",opacity:1,isolation:"auto",mixBlendMode:"normal",colorInterpolation:"sRGB",colorInterpolationFilters:"linearRGB",solidColor:"#000000",solidOpacity:1,vectorEffect:"none",fill:"#000000",fillOpacity:.5,fillRule:"nonzero",stroke:"none",strokeWidth:"0.0385953px",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1,colorRendering:"auto",imageRendering:"auto",shapeRendering:"auto",textRendering:"auto",enableBackground:"accumulate",stopColor:"#000000",stopOpacity:1},d:"m 17.871094,15.345703 a 0.1322915,0.1322915 0 0 0 -0.105469,0.03906 l -3.439453,3.439453 a 0.1322915,0.1322915 0 0 0 0,0.1875 0.1322915,0.1322915 0 0 0 0.1875,0 l 3.439453,-3.439453 a 0.1322915,0.1322915 0 0 0 0,-0.1875 0.1322915,0.1322915 0 0 0 -0.08203,-0.03906 z",id:"path859"}))))}var ee=i.forwardRef($),te=(r.p,r(8)),re=r.n(te),ae=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).webcam=s.a.createRef(),a.state={errorState:"noError",videoConstraints:{facingMode:"environment",width:4096,height:2160,frameRate:60}},a}return Object(u.a)(r,[{key:"renderPage",value:function(){switch(this.state.errorState){case"noError":return Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(Y.a,{audio:!1,ref:this.webcam,onUserMedia:this.mediaStream.bind(this),onUserMediaError:this.mediaError.bind(this),videoConstraints:this.state.videoConstraints,screenshotFormat:"image/png",className:re.a.CameraWebcam}),Object(V.jsx)(q,{onCapture:this.capture.bind(this)})]});case"noCamera":return Object(V.jsx)("div",{className:re.a.CameraError,children:Object(V.jsxs)("div",{className:re.a.CameraErrorContainer,children:[Object(V.jsx)(ee,{className:re.a.CameraErrorGlyph}),Object(V.jsx)("h1",{children:"There is no camera on this device."})]})});case"noSupport":return Object(V.jsx)("div",{className:re.a.CameraError,children:Object(V.jsxs)("div",{className:re.a.CameraErrorContainer,children:[Object(V.jsx)(ee,{className:re.a.CameraErrorGlyph}),Object(V.jsx)("h1",{children:"This browser is unsupported"}),Object(V.jsxs)("div",{children:[Object(V.jsx)("p",{children:"Use a browser that can access the camera. Possible options are:"}),Object(V.jsxs)("ul",{children:[Object(V.jsx)("li",{children:"Google Chrome"}),Object(V.jsx)("li",{children:"Firefox"}),Object(V.jsx)("li",{children:"Safari"}),Object(V.jsx)("li",{children:"Microsoft Edge"})]})]})]})});case"noPermission":return Object(V.jsx)("div",{className:re.a.CameraError,children:Object(V.jsxs)("div",{className:re.a.CameraErrorContainer,children:[Object(V.jsx)(ee,{className:re.a.CameraErrorGlyph}),Object(V.jsx)("h1",{children:"Can't access the camera"}),Object(V.jsx)("div",{children:Object(V.jsx)("p",{children:"Check the permissions for this page, and then reload the page to try again."})})]})});default:return Object(V.jsx)("div",{className:re.a.CameraError,children:Object(V.jsxs)("div",{className:re.a.CameraErrorContainer,children:[Object(V.jsx)(ee,{className:re.a.CameraErrorGlyph}),Object(V.jsx)("h1",{children:"Can't access the camera"})]})})}}},{key:"render",value:function(){return Object(V.jsx)("div",{className:re.a.CameraPage,children:this.renderPage()})}},{key:"mediaStream",value:function(e){console.log(e)}},{key:"mediaError",value:function(e){if(console.log(e),"getUserMedia is not implemented in this browser"!==e.message)switch(e.name){case"NotFoundError":this.setState({errorState:"noCamera"});break;case"NotAllowedError":this.setState({errorState:"noPermission"});break;default:this.setState({errorState:"genericError"})}else this.setState({errorState:"noSupport"})}},{key:"capture",value:function(){var e=this.webcam.current.getScreenshot();R.sendBase64Picture(e)}}]),r}(s.a.Component),ne=r(18),ie=r.n(ne),se=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).state={percent:1},a}return Object(u.a)(r,[{key:"componentDidMount",value:function(){var e=this;setInterval((function(){e.setState((function(e){return{percent:e.percent>1.5?0:e.percent+.01}}))}),10)}},{key:"polarToCartesian",value:function(e,t,r,a){var n=(a-90)*Math.PI/180;return{x:e+r*Math.cos(n),y:t+r*Math.sin(n)}}},{key:"describeArc",value:function(e,t,r,a,n){var i=this.polarToCartesian(e,t,r,n),s=this.polarToCartesian(e,t,r,a),o=n-a<=180?"0":"1";return["M",i.x,i.y,"A",r,r,0,o,0,s.x,s.y].join(" ")}},{key:"renderProgressPath",value:function(){var e=this.props.job.percentComplete();return e>=1?Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)("circle",{id:"circle",stroke:"#ffffff",fill:"#00000000",strokeWidth:10,cx:55,cy:55,r:50}),Object(V.jsx)("path",{id:"check",stroke:"#ffffff",fill:"#00000000",strokeWidth:10,d:"M 30 60 L 50 75 L 75 30"})]}):Object(V.jsx)("path",{id:"arc",stroke:"#ffffff",fill:"#00000000",strokeWidth:10,d:this.describeArc(55,55,50,0,360*e)})}},{key:"render",value:function(){return Object(V.jsx)("div",{className:ie.a.TransferItem,style:{backgroundImage:'linear-gradient( rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5) ), url("'.concat(this.props.job.imageData(),'")')},children:Object(V.jsx)("svg",{className:ie.a.Spinner,width:110,height:110,children:this.renderProgressPath()})})}}]),r}(s.a.Component),oe=r(22),ce=r.n(oe),le=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).state={jobs:[]},a}return Object(u.a)(r,[{key:"componentDidMount",value:function(){E.on("progressUpdated",this.progressUpdated.bind(this)),this.progressUpdated()}},{key:"componentWillUnmount",value:function(){E.removeListener("progressUpdated",this.progressUpdated.bind(this))}},{key:"progressUpdated",value:function(){this.setState({jobs:Object(f.a)(E.jobs()).reverse()})}},{key:"render",value:function(){return Object(V.jsx)("div",{className:ce.a.TransferGrid,children:this.state.jobs.map((function(e){return Object(V.jsx)(se,{job:e})}))})}}]),r}(s.a.Component),ue=r(23),de=r(10),he=r.n(de),pe=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).state={isDropping:!1},a.filePicker=s.a.createRef(),a}return Object(u.a)(r,[{key:"dragEnter",value:function(e){e.dataTransfer.types.includes("Files")&&(e.preventDefault(),e.stopPropagation(),this.setState({isDropping:!0}))}},{key:"dragLeave",value:function(e){e.preventDefault(),e.stopPropagation(),this.setState({isDropping:!1})}},{key:"dragOver",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"drop",value:function(e){var t;e.preventDefault(),e.stopPropagation(),this.setState({isDropping:!1}),t=e.dataTransfer.items?Array.from(e.dataTransfer.items).filter((function(e){return"file"===e.kind})).map((function(e){return e.getAsFile()})):e.dataTransfer.files,this.uploadFiles(t)}},{key:"pickFileClicked",value:function(){this.filePicker.current.click()}},{key:"pickFile",value:function(e){this.uploadFiles(Array.from(e.target.files)),e.target.value=""}},{key:"uploadFiles",value:function(e){try{e.length;if(0===(e=e.filter((function(e){return["image/png","image/jpeg","image/gif"].includes(e.type)}))).length)throw new Error("Not a file!");e.length,console.log("Uploading ".concat(e.length," files."));var t,r=Object(ue.a)(e);try{var a=function(){var e=t.value,r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){R.sendBase64Picture(r.result)}};for(r.s();!(t=r.n()).done;)a()}catch(n){r.e(n)}finally{r.f()}this.props.onUploadSelected()}catch(n){console.log("Not valid files")}}},{key:"render",value:function(){return Object(V.jsx)("div",{className:[he.a.UploadScreen,this.state.isDropping?he.a.Dropping:""].filter((function(e){return""!==e})).join(" "),onDragEnter:this.dragEnter.bind(this),onDragLeave:this.dragLeave.bind(this),onDragOver:this.dragOver.bind(this),onDrop:this.drop.bind(this),children:Object(V.jsxs)("div",{className:he.a.UploadContainer,children:[Object(V.jsx)("h1",{children:"Upload a picture"}),"Go ahead and drop a picture here to upload it.",Object(V.jsx)("div",{className:he.a.UploadButton,onClick:this.pickFileClicked.bind(this),children:"Pick File"}),Object(V.jsx)("input",{type:"file",multiple:!0,onChange:this.pickFile.bind(this),className:he.a.FilePicker,ref:this.filePicker})]})})}}]),r}(s.a.Component),be=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),(a=t.call(this,e)).state={page:"camera"},a}return Object(u.a)(r,[{key:"changePage",value:function(e){this.setState({page:e})}},{key:"exit",value:function(){R.disconnect()}},{key:"render",value:function(){return Object(V.jsxs)("div",{className:"mainWrapper",children:[Object(V.jsx)(G,{page:this.state.page,onChangePage:this.changePage.bind(this),onExit:this.exit.bind(this)}),this.renderPage()]})}},{key:"renderPage",value:function(){switch(this.state.page){case"camera":return Object(V.jsx)(ae,{});case"transfers":return Object(V.jsx)(le,{});case"upload":return Object(V.jsx)(pe,{onUploadSelected:this.onUploadSelected.bind(this)});default:return Object(V.jsx)("span",{children:"Please navigate to another page"})}}},{key:"onUploadSelected",value:function(){this.changePage("transfers")}}]),r}(s.a.Component),fe=function(e){Object(d.a)(r,e);var t=Object(h.a)(r);function r(e){var a;return Object(l.a)(this,r),a=t.call(this,e),R.setWsStateChangeHandler((function(){a.setState({isConnected:R.isConnected()})})),a.state={isConnected:!1},a}return Object(u.a)(r,[{key:"renderMainPage",value:function(){return this.state.isConnected?Object(V.jsx)(be,{}):Object(V.jsx)(L,{})}},{key:"render",value:function(){return Object(V.jsx)("div",{className:"App",children:this.renderMainPage()})}}]),r}(s.a.Component),je=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,33)).then((function(t){var r=t.getCLS,a=t.getFID,n=t.getFCP,i=t.getLCP,s=t.getTTFB;r(e),a(e),n(e),i(e),s(e)}))};c.a.render(Object(V.jsx)(s.a.StrictMode,{children:Object(V.jsx)(fe,{})}),document.getElementById("root")),je()},8:function(e,t,r){e.exports={CameraPage:"CameraScreen_CameraPage__2U6d4",CameraError:"CameraScreen_CameraError__2Vc3i",CameraErrorContainer:"CameraScreen_CameraErrorContainer__1nYUF",CameraErrorGlyph:"CameraScreen_CameraErrorGlyph__3xVLf",CameraWebcam:"CameraScreen_CameraWebcam__2BsjO",CaptureButton:"CameraScreen_CaptureButton__goaOq"}}},[[32,1,2]]]);
//# sourceMappingURL=main.1431c21d.chunk.js.map